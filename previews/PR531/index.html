<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · AMDGPU.jl</title><meta name="title" content="Home · AMDGPU.jl"/><meta property="og:title" content="Home · AMDGPU.jl"/><meta property="twitter:title" content="Home · AMDGPU.jl"/><meta name="description" content="Documentation for AMDGPU.jl."/><meta property="og:description" content="Documentation for AMDGPU.jl."/><meta property="twitter:description" content="Documentation for AMDGPU.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="AMDGPU.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>AMDGPU.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#The-Julia-AMDGPU-stack"><span>The Julia AMDGPU stack</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Requirements"><span>Requirements</span></a></li><li><a class="tocitem" href="#Preferences"><span>Preferences</span></a></li></ul></li><li><a class="tocitem" href="quickstart/">Quick Start</a></li><li><a class="tocitem" href="devices/">Devices</a></li><li><a class="tocitem" href="streams/">Streams</a></li><li><a class="tocitem" href="kernel_launch/">Kernel Launch</a></li><li><a class="tocitem" href="exceptions/">Exceptions</a></li><li><a class="tocitem" href="profiling/">Profiling</a></li><li><a class="tocitem" href="memory/">Memory</a></li><li><a class="tocitem" href="hostcall/">Host-Call</a></li><li><span class="tocitem">Intrinsics</span><ul><li><a class="tocitem" href="execution_control/">Execution Control</a></li></ul></li><li><a class="tocitem" href="printing/">Printing</a></li><li><a class="tocitem" href="logging/">Logging</a></li><li><a class="tocitem" href="api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGPU/AMDGPU.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGPU/AMDGPU.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Programming-AMD-GPUs-with-Julia"><a class="docs-heading-anchor" href="#Programming-AMD-GPUs-with-Julia">Programming AMD GPUs with Julia</a><a id="Programming-AMD-GPUs-with-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Programming-AMD-GPUs-with-Julia" title="Permalink"></a></h1><h2 id="The-Julia-AMDGPU-stack"><a class="docs-heading-anchor" href="#The-Julia-AMDGPU-stack">The Julia AMDGPU stack</a><a id="The-Julia-AMDGPU-stack-1"></a><a class="docs-heading-anchor-permalink" href="#The-Julia-AMDGPU-stack" title="Permalink"></a></h2><p>Julia support for programming AMD GPUs is currently provided by the <a href="https://github.com/JuliaGPU/AMDGPU.jl">AMDGPU.jl</a> package. This package contains everything necessary to program for AMD GPUs in Julia, including:</p><ul><li>An interface for compiling and running kernels written in Julia through LLVM&#39;s AMDGPU backend.</li><li>An interface for working with the HIP runtime API,   necessary for launching compiled kernels and controlling the GPU.</li><li>An array type implementing the <a href="https://github.com/JuliaGPU/GPUArrays.jl">GPUArrays.jl</a>   interface, providing high-level array operations.</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Simply add the AMDGPU.jl package to your Julia environment:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;AMDGPU&quot;)</code></pre><p>To ensure that everything works, you can run the test suite:</p><pre><code class="language-julia hljs">using AMDGPU
using Pkg
Pkg.test(&quot;AMDGPU&quot;)</code></pre><h2 id="Requirements"><a class="docs-heading-anchor" href="#Requirements">Requirements</a><a id="Requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Requirements" title="Permalink"></a></h2><p>Julia <strong>1.9 or higher</strong>.</p><p>Minimal supported ROCm version is <strong>5.3</strong>. However, if you have ROCm 5.5+ installed, refer to <a href="#LLVM-compatibility-and-mixed-ROCm-mode">LLVM compatibility &amp; mixed ROCm mode</a> section for additional instructions.</p><p>For optimal experience, you should have full ROCm stack installed. Refer to official ROCm stack installation instructions: <a href="https://rocm.docs.amd.com/en/latest/deploy/linux/index.html">https://rocm.docs.amd.com/en/latest/deploy/linux/index.html</a></p><p>Currently, AMDGPU.jl utilizes following libraries:</p><p><a href="https://github.com/RadeonOpenCompute/ROCT-Thunk-Interface">ROCT</a>, <a href="https://github.com/RadeonOpenCompute/ROCR-Runtime">ROCR</a>, <a href="https://github.com/RadeonOpenCompute/ROCm-Device-Libs">ROCm-Device-Libs</a>, <a href="https://github.com/ROCm-Developer-Tools/HIP">HIP</a>, <a href="https://github.com/ROCmSoftwarePlatform/rocBLAS">rocBLAS</a>, <a href="https://github.com/ROCmSoftwarePlatform/rocFFT">rocFFT</a>, <a href="https://github.com/ROCmSoftwarePlatform/rocSOLVER">rocSOLVER</a>, <a href="https://github.com/ROCmSoftwarePlatform/rocSPARSE">rocSPARSE</a>, <a href="https://github.com/ROCmSoftwarePlatform/rocRAND">rocRAND</a>, <a href="https://github.com/ROCmSoftwarePlatform/MIOpen">MIOpen</a>.</p><h3 id="ROCm-artifacts"><a class="docs-heading-anchor" href="#ROCm-artifacts">ROCm artifacts</a><a id="ROCm-artifacts-1"></a><a class="docs-heading-anchor-permalink" href="#ROCm-artifacts" title="Permalink"></a></h3><p>There is limited support for ROCm 5.4+ artifacts which can be enabled with <a href="#AMDGPU.ROCmDiscovery.enable_artifacts!"><code>AMDGPU.enable_artifacts!</code></a>.</p><p>Limited means not all libraries are available and some of the functionality may be disabled.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AMDGPU.ROCmDiscovery.enable_artifacts!" href="#AMDGPU.ROCmDiscovery.enable_artifacts!"><code>AMDGPU.ROCmDiscovery.enable_artifacts!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">enable_artifacts!(flag::Bool = true)</code></pre><p>Pass <code>true</code> to switch from system-wide ROCm installtion to artifacts. When using artifacts, system-wide installation is not needed at all.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/AMDGPU.jl/blob/f203bccc8fb355a0db3f467dc92b43680f0d53e7/src/discovery/discovery.jl#L8-L13">source</a></section></article><h3 id="LLVM-compatibility-and-mixed-ROCm-mode"><a class="docs-heading-anchor" href="#LLVM-compatibility-and-mixed-ROCm-mode">LLVM compatibility &amp; mixed ROCm mode</a><a id="LLVM-compatibility-and-mixed-ROCm-mode-1"></a><a class="docs-heading-anchor-permalink" href="#LLVM-compatibility-and-mixed-ROCm-mode" title="Permalink"></a></h3><p>As a rule of thumb, Julia LLVM version should match ROCm LLVM version. For example Julia 1.10 uses LLVM 15, but ROCm 5.5+ uses LLVM 16 which are incompatible.</p><p>However, there is a way to run system ROCm 5.5+ with Julia:</p><ol><li>Add respective version of artifact device libraries in your project:<ul><li>ROCm 5.5: <code>]add ROCmDeviceLibs_jll@5.5</code>;</li><li>ROCm 5.6: <code>]add ROCmDeviceLibs_jll@5.6</code>.</li></ul></li><li>Call <a href="#AMDGPU.ROCmDiscovery.use_devlibs_jll!"><code>AMDGPU.use_devlibs_jll!</code></a> in your Julia session to switch  to artifact device libraries (and the rest of the libraries  will be used from system-wide installation).</li></ol><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AMDGPU.ROCmDiscovery.use_devlibs_jll!" href="#AMDGPU.ROCmDiscovery.use_devlibs_jll!"><code>AMDGPU.ROCmDiscovery.use_devlibs_jll!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">use_devlibs_jll!(flag::Bool = true)</code></pre><p>Pass <code>true</code> to use device libraries from artifacts and the rest of the libraries from system-wide ROCm installation (mixed-mode).</p><p>This allows using ROCm 5.5+ which internally uses LLVM 16+, but device libraries from artifacts are built with LLVM 15 which makes them compatible with Julia.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/AMDGPU.jl/blob/f203bccc8fb355a0db3f467dc92b43680f0d53e7/src/discovery/discovery.jl#L33-L42">source</a></section></article><h3 id="Extra-Setup-Details"><a class="docs-heading-anchor" href="#Extra-Setup-Details">Extra Setup Details</a><a id="Extra-Setup-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Extra-Setup-Details" title="Permalink"></a></h3><p>List of additional steps that may be needed to take to ensure everything is working:</p><ul><li><p>Make sure your user is in the same group as <code>/dev/kfd</code>, other than <code>root</code>.</p><p>For example, it might be the <code>render</code> group:</p><p><code>crw-rw----   1 root   render  234,   0 Aug  5 11:43 kfd</code></p><p>In this case, you can add yourself to it:</p><p><code>sudo usermod -aG render username</code></p></li><li><p>ROCm libraries should be in the standard library locations, or in your <code>LD_LIBRARY_PATH</code>.</p></li><li><p>If you get an error message along the lines of <code>GLIB_CXX_... not found</code>,   it&#39;s possible that the C++ runtime used to build the ROCm stack   and the one used by Julia are different.   If you built the ROCm stack yourself this is very likely the case   since Julia normally ships with its own C++ runtime.</p><p>For more information, check out this <a href="https://github.com/JuliaLang/julia/issues/34276">GitHub issue</a>.   A quick fix is to use the <code>LD_PRELOAD</code> environment variable to make Julia use the system C++ runtime library, for example:</p><p><code>LD_PRELOAD=/usr/lib/libstdc++.so julia</code></p><p>Alternatively, you can build Julia from source as described   <a href="https://github.com/JuliaLang/julia/blob/master/doc/build/build.md">here</a>.   To quickly debug this issue start Julia and try to load a ROCm library:</p><p><code>using Libdl   Libdl.dlopen(&quot;/opt/rocm/hsa/lib/libhsa-runtime64.so.1&quot;)</code></p></li><li><p><code>ld.lld</code> should be in your <code>PATH</code>.</p></li><li><p>For better experience use whatever Linux kernel   is officially supported by ROCm stack.</p></li></ul><p>Once all of this is setup properly, you should be able to do <code>using AMDGPU</code> successfully.</p><p>See the <a href="quickstart/#Quick-Start">Quick Start</a> documentation for an introduction to using AMDGPU.jl.</p><h2 id="Preferences"><a class="docs-heading-anchor" href="#Preferences">Preferences</a><a id="Preferences-1"></a><a class="docs-heading-anchor-permalink" href="#Preferences" title="Permalink"></a></h2><p>AMDGPU.jl supports setting <a href="https://github.com/JuliaPackaging/Preferences.jl">preferences</a>. Template of <code>LocalPreferences.toml</code> with all options:</p><pre><code class="language-toml hljs">[AMDGPU]
# If `true` then use ROCm libraries provided by artifacts.
# However, not all ROCm libraries are available as artifacts.
use_artifacts = false
# Use mixed-mode ROCm. This will use device libraries from artifacts,
# but the rest of the ROCm libraries from system-wide installation.
# See `LLVM compatibility &amp; mixed ROCm mode` section in the documentation.
use_devlibs_jll = false
# Use non-blocking synchronization for all `AMDGPU.synchronize()` calls.
nonblocking_synchronization = true
# Memory limit specifies maximum amount of memory in percentages
# a current Julia process can use.
# Default is &quot;none&quot;, which does not apply any limitation.
hard_memory_limit = &quot;none&quot;
# Notice a space between the value and percentage sign.
# hard_memory_limit = &quot;80 %&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="quickstart/">Quick Start »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Wednesday 25 October 2023 10:02">Wednesday 25 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
