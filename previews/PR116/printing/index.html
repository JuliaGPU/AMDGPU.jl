<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Printing · AMDGPU.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="AMDGPU.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">AMDGPU.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../queues_signals/">Queues and Signals</a></li><li><a class="tocitem" href="../kernel_deps/">Kernel Dependencies</a></li><li><a class="tocitem" href="../globals/">Global Variables</a></li><li><a class="tocitem" href="../exceptions/">Exceptions</a></li><li class="is-active"><a class="tocitem" href>Printing</a><ul class="internal"><li><a class="tocitem" href="#Differences-to-@cuprintf"><span>Differences to <code>@cuprintf</code></span></a></li></ul></li><li><a class="tocitem" href="../memory/">Memory</a></li><li><span class="tocitem">Intrinsics</span><ul><li><a class="tocitem" href="../execution_control/">Execution Control</a></li><li><a class="tocitem" href="../wavefront_ops/">Wavefront Operations</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Printing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Printing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGPU/AMDGPU.jl/blob/master/docs/src/printing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Printing"><a class="docs-heading-anchor" href="#Printing">Printing</a><a id="Printing-1"></a><a class="docs-heading-anchor-permalink" href="#Printing" title="Permalink"></a></h1><p>Writing GPU kernels can be a difficult endeavor, owing to the fact that the LLVM GPU backends turn serial code into parallel code automatically. Recognizing this, every good GPU programming interface allows the user&#39;s GPU kernels to print output to a buffer, which will be passed to the host for display. With the ability to interpolate variables, this functionality serves as the &quot;printf of GPUs&quot;. Quite literally, the primary tool for this is <code>@rocprintf</code>. Here&#39;s a simple example of printing the current workgroup index:</p><pre><code class="language-julia">function kernel(x)
    @rocprintf &quot;Workgroup index: %d\n&quot; workgroupIdx().x
    nothing
end</code></pre><p>The above kernel would print out the string &quot;Workgroup index: 1\n&quot; when run with a single workgroup (where &quot;\n&quot; means a newline).</p><p>Any number of variables may be passed to <code>@rocprintf</code>, as long as those variables have a printf-compatible implementation in <code>Printf</code>. Calls to <code>@rocprintf</code> are blocking, and will not return control to the kernel until the string has been formatted and sent to the OS runtime for printing (the same as for regular calls to <code>@printf</code>).</p><p>While <code>@rocprintf</code> is printed once per wavefront, it&#39;s possible to print once per lane by doing a simple loop:</p><pre><code class="language-julia">function kernel(x)
    for i in 1:workgroupDim().x
        idx = workitemIdx().x
        if i == idx
            @rocprintf &quot;My index is %d\n&quot; idx
        end
    end
    nothing
end</code></pre><p>The above kernel, when run with just 4 workitems in a single workgroup, will print out:</p><p>My index is 1 My index is 2 My index is 3 My index is 4</p><h2 id="Differences-to-@cuprintf"><a class="docs-heading-anchor" href="#Differences-to-@cuprintf">Differences to <code>@cuprintf</code></a><a id="Differences-to-@cuprintf-1"></a><a class="docs-heading-anchor-permalink" href="#Differences-to-@cuprintf" title="Permalink"></a></h2><p>Similar to CUDA&#39;s <code>@cuprintf</code>, <code>@rocprintf</code> is a printf-compatible macro which takes a format string and arguments, and commands the host CPU to display it as formatted text. In contrast to <code>@cuprintf</code>, however, is that we use AMDGPU&#39;s hostcall and Julia&#39;s <code>Printf</code> stdlib to implement this. This means that anything that <code>Printf</code> can print, so can <code>@rocprintf</code>. The macro is also handled as a regular hostcall, which means that argument types are checked at compile time (although currently, any errors while printing will be detected on the host, and will terminate the kernel).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../exceptions/">« Exceptions</a><a class="docs-footer-nextpage" href="../memory/">Memory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 16 March 2021 23:59">Tuesday 16 March 2021</span>. Using Julia version 1.6.0-rc3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
